#pragma version 4
// int 1

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Identification
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

global GroupSize
int 10
==
bnz success

global GroupSize
int 2 
==
bz not_group_size_2

gtxn 0 TypeEnum 
int appl
==
gtxn 0 ApplicationID 
int {app_id}
==
&&
gtxn 1 TypeEnum
int axfer
==
&&
bnz branch_harvest

b branch_withdraw

not_group_size_2:

b failure

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Handling
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

branch_harvest:
b success

branch_withdraw:
// pay fee
gtxn 0 TypeEnum
int pay
==
// it's an asset transfer
gtxn 1 TypeEnum
int axfer
==
&&
// asset has the expected id 
gtxn 1 XferAsset
int {funds_asset_id}
==
&&
// project creator is the receiver
gtxn 1 AssetReceiver
addr {project_creator_address}
==
&&
return

success:
int 1
return

failure:
int 0
return
